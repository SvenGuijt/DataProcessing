<!DOCTYPE html>
<html>

<body>

	<textarea id="rawdata">
	#date,maxtemp
	  20160101,   41
	  20160102,   54
	  20160103,   69
	  20160104,   57
	  20160105,   68
	  20160106,   26
	  20160107,   61
	  20160108,   54
	  20160109,   56
	  20160110,   69
	  20160111,   48
	  20160112,   58
	  20160113,   50
	  20160114,   35
	  20160115,   24
	  20160116,   27
	  20160117,  -10
	  20160118,  -33
	  20160119,  -25
	  20160120,   12
	  20160121,  -12
	  20160122,    9
	  20160123,   66
	  20160124,   77
	  20160125,  107
	  20160126,   92
	  20160127,  109
	  20160128,   67
	  20160129,   85
	  20160130,   74
	  20160131,   68
	  20160201,  115
	  20160202,   89
	  20160203,   50
	  20160204,   51
	  20160205,   87
	  20160206,   94
	  20160207,   85
	  20160208,   85
	  20160209,   53
	  20160210,   48
	  20160211,   38
	  20160212,   27
	  20160213,   18
	  20160214,   14
	  20160215,   23
	  20160216,   -3
	  20160217,  -13
	  20160218,   13
	  20160219,   39
	  20160220,   82
	  20160221,  104
	  20160222,   68
	  20160223,   43
	  20160224,   23
	  20160225,   18
	  20160226,   21
	  20160227,   22
	  20160228,   22
	  20160229,   13
	  20160301,   20
	  20160302,   53
	  20160303,   39
	  20160304,   10
	  20160305,    5
	  20160306,   30
	  20160307,   25
	  20160308,   36
	  20160309,   44
	  20160310,   41
	  20160311,   32
	  20160312,   31
	  20160313,   39
	  20160314,   41
	  20160315,   46
	  20160316,   44
	  20160317,   57
	  20160318,   52
	  20160319,   62
	  20160320,   68
	  20160321,   72
	  20160322,   76
	  20160323,   76
	  20160324,   79
	  20160325,   65
	  20160326,   95
	  20160327,   91
	  20160328,   97
	  20160329,   78
	  20160330,   81
	  20160331,   76
	  20160401,   72
	  20160402,  101
	  20160403,  152
	  20160404,  124
	  20160405,  106
	  20160406,   89
	  20160407,   73
	  20160408,   67
	  20160409,   92
	  20160410,  107
	  20160411,  132
	  20160412,  116
	  20160413,   90
	  20160414,  106
	  20160415,  103
	  20160416,   86
	  20160417,   62
	  20160418,   81
	  20160419,   97
	  20160420,   86
	  20160421,  101
	  20160422,   87
	  20160423,   62
	  20160424,   46
	  20160425,   49
	  20160426,   48
	  20160427,   60
	  20160428,   58
	  20160429,   74
	  20160430,   77
	  20160501,   79
	  20160502,  115
	  20160503,   97
	  20160504,   95
	  20160505,  128
	  20160506,  164
	  20160507,  195
	  20160508,  201
	  20160509,  202
	  20160510,  189
	  20160511,  204
	  20160512,  202
	  20160513,  154
	  20160514,   89
	  20160515,   86
	  20160516,   93
	  20160517,  123
	  20160518,  136
	  20160519,  134
	  20160520,  137
	  20160521,  179
	  20160522,  155
	  20160523,  120
	  20160524,  114
	  20160525,  118
	  20160526,  137
	  20160527,  160
	  20160528,  176
	  20160529,  172
	  20160530,  162
	  20160531,  182
	  20160601,  192
	  20160602,  153
	  20160603,  164
	  20160604,  201
	  20160605,  200
	  20160606,  189
	  20160607,  201
	  20160608,  161
	  20160609,  153
	  20160610,  164
	  20160611,  162
	  20160612,  166
	  20160613,  159
	  20160614,  152
	  20160615,  146
	  20160616,  157
	  20160617,  151
	  20160618,  141
	  20160619,  153
	  20160620,  155
	  20160621,  170
	  20160622,  201
	  20160623,  220
	  20160624,  192
	  20160625,  154
	  20160626,  149
	  20160627,  149
	  20160628,  167
	  20160629,  160
	  20160630,  164
	  20160701,  169
	  20160702,  154
	  20160703,  147
	  20160704,  170
	  20160705,  154
	  20160706,  149
	  20160707,  168
	  20160708,  175
	  20160709,  197
	  20160710,  213
	  20160711,  186
	  20160712,  166
	  20160713,  145
	  20160714,  145
	  20160715,  166
	  20160716,  197
	  20160717,  198
	  20160718,  202
	  20160719,  228
	  20160720,  254
	  20160721,  218
	  20160722,  211
	  20160723,  211
	  20160724,  207
	  20160725,  182
	  20160726,  184
	  20160727,  179
	  20160728,  190
	  20160729,  183
	  20160730,  177
	  20160731,  170
	  20160801,  165
	  20160802,  166
	  20160803,  190
	  20160804,  173
	  20160805,  176
	  20160806,  164
	  20160807,  184
	  20160808,  172
	  20160809,  144
	  20160810,  128
	  20160811,  136
	  20160812,  189
	  20160813,  176
	  20160814,  170
	  20160815,  161
	  20160816,  163
	  20160817,  172
	  20160818,  177
	  20160819,  181
	  20160820,  178
	  20160821,  167
	  20160822,  180
	  20160823,  210
	  20160824,  228
	  20160825,  243
	  20160826,  221
	  20160827,  216
	  20160828,  205
	  20160829,  172
	  20160830,  162
	  20160831,  174
	  20160901,  172
	  20160902,  166
	  20160903,  185
	  20160904,  179
	  20160905,  173
	  20160906,  177
	  20160907,  183
	  20160908,  196
	  20160909,  169
	  20160910,  184
	  20160911,  185
	  20160912,  209
	  20160913,  235
	  20160914,  230
	  20160915,  226
	  20160916,  174
	  20160917,  173
	  20160918,  167
	  20160919,  144
	  20160920,  145
	  20160921,  147
	  20160922,  138
	  20160923,  136
	  20160924,  152
	  20160925,  163
	  20160926,  135
	  20160927,  145
	  20160928,  187
	  20160929,  159
	  20160930,  145
	  20161001,  135
	  20161002,  121
	  20161003,  145
	  20161004,  130
	  20161005,   98
	  20161006,   94
	  20161007,  118
	  20161008,  110
	  20161009,   79
	  20161010,   79
	  20161011,   80
	  20161012,   89
	  20161013,   91
	  20161014,   99
	  20161015,  107
	  20161016,  133
	  20161017,  121
	  20161018,  102
	  20161019,   88
	  20161020,   85
	  20161021,   76
	  20161022,   67
	  20161023,   48
	  20161024,   71
	  20161025,   87
	  20161026,   95
	  20161027,  118
	  20161028,  131
	  20161029,   96
	  20161030,   87
	  20161031,   85
	  20161101,   81
	  20161102,   72
	  20161103,   67
	  20161104,   76
	  20161105,   69
	  20161106,   61
	  20161107,   42
	  20161108,   19
	  20161109,   30
	  20161110,   40
	  20161111,   18
	  20161112,   20
	  20161113,   27
	  20161114,   31
	  20161115,  108
	  20161116,  119
	  20161117,   93
	  20161118,   60
	  20161119,   58
	  20161120,   84
	  20161121,  120
	  20161122,  110
	  20161123,   79
	  20161124,   66
	  20161125,   33
	  20161126,   -1
	  20161127,   56
	  20161128,   -3
	  20161129,  -31
	  20161130,   20
	  20161201,   79
	  20161202,   52
	  20161203,   -1
	  20161204,  -14
	  20161205,  -27
	  20161206,    1
	  20161207,   63
	  20161208,   82
	  20161209,   91
	  20161210,   78
	  20161211,   85
	  20161212,   53
	  20161213,   66
	  20161214,   73
	  20161215,   65
	  20161216,   54
	  20161217,   61
	  20161218,   62
	  20161219,   43
	  20161220,   -6
	  20161221,   41
	  20161222,   59
	  20161223,   60
	  20161224,   79
	  20161225,  104
	  20161226,   83
	  20161227,   66
	  20161228,   10
	  20161229,  -22
	  20161230,  -11
	  20161231,   18
	</textarea>
	<canvas width="800" height="500"></canvas>
	<script>
		var data = document.getElementById("rawdata").textContent;

		// split text (data) into lines and drop out non-data indices
		arrayOfLines = data.match(/[^\r\n]+/g);
		arrayOfLines.shift();
		arrayOfLines.pop();

		// initialize data arrays and loop variables
		var date = 0;
		var temperature = 0;
		var dates = [];
		var temps = [];
		var length = arrayOfLines.length;

		// iterate over each line and fill arrays with data
		for (var i = 0; i < length; i++){
		var datapoint = arrayOfLines[i].split(",");
		date = parseInt(datapoint[0]);
		//date = new Date(parseInt(datapoint[0]));
		temperature = parseInt(datapoint[1]);
		dates.push(date)
		temps.push(temperature)
		}
		console.log(arrayOfLines)
		console.log(dates)
		console.log(temps)


		function createTransform(domain, range){
		// domain is a two-element array of the data bounds [domain_min, domain_max]
		// range is a two-element array of the screen bounds [range_min, range_max]
		// this gives you two equations to solve:
		// range_min = alpha * domain_min + beta
		// range_max = alpha * domain_max + beta
	 		// a solution would be:

	    var domain_min = domain[0]
	    var domain_max = domain[1]
	    var range_min = range[0]
	    var range_max = range[1]

	    // formulas to calculate the alpha and the beta
	   	var alpha = (range_max - range_min) / (domain_max - domain_min)
	    var beta = range_max - alpha * domain_max

	    // returns the function for the linear transformation (y= a * x + b)
	    	return function(x){
		      return alpha * x + beta;
		    }
		}

		// create coordinte transformation functions
		scalingXaxis = createTransform([0,366], [60,780])
		scalingYaxis = createTransform([-33,260], [80,420])

		// set canvas settings to 2d
		var canvas = document.querySelector("canvas");
		var ctx = canvas.getContext('2d');

		// draw title
		ctx.font = '20px serif';
		ctx.fillText('Gemiddelde temperatuur in 2016 in De Bilt (NL)', 250, 40);

		// draw y-axis values
		ctx.font = '12px serif';
		yvalues = [25, 20, 15, 10, 5, 0, -5]

		for (var i = 0; i < 7; i++){
			ctx.fillText(yvalues[i], 35, 95+58*i);
		}


		// draw months on x-axis
		ctx.font = '12px serif';
		months = ['January', 'February', 'March', 'April', 'May', 'June', 
		'July', 'August', 'September', 'Octobre', 'November', 'December']

		ctx.translate(70, 490)
		ctx.rotate(315 * Math.PI / 180)
		for (var i = 0; i < 12; i++){
			ctx.fillText(months[i], 43*i, 43*i);
		}
		ctx.setTransform(1, 0, 0, 1, 0, 0);

		// transform coordinate system where origin is on lower-left
		ctx.translate(0, 500);
		ctx.scale(1, -1);

		ctx.beginPath();

		// draw x- and y-axis
		ctx.moveTo(60,60);
		ctx.lineTo(780,60);
		ctx.moveTo(60,60);
		ctx.lineTo(60,420);

		// draw grids along x-axis
		for (var i = 60; i <= 780; i += 60) {
			ctx.moveTo(i,60);
			ctx.lineTo(i,52);
		}

		// draw grids along y-axis
		for (var i = 60; i <= 420; i += 58) {
			ctx.moveTo(60,i);
			ctx.lineTo(52,i);
		}

		// draw lines on set paths
		ctx.stroke();

		// draw graph of average temperature
		ctx.beginPath();
		for (var y = 0; y < 366; y += 1) {
		ctx.lineTo(scalingXaxis(y), scalingYaxis(temps[y]));
		ctx.moveTo(scalingXaxis(y), scalingYaxis(temps[y]));
		}
		
		ctx.stroke();




	</script>



</body>
</html>
